<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">


    <!-- Active mentors -->
    <changeSet id="001-create-active-mentors" author="init">
        <createTable tableName="active_mentors" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="mentors" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.active_mentors OWNER TO report321;</sql>
    </changeSet>


    <!-- Daily -->
    <changeSet id="002-create-daily" author="init">
        <createTable tableName="daily" schemaName="public">
            <column name="id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="chat_id" type="VARCHAR(255)"/>
            <column name="message" type="VARCHAR(255)"/>
            <column name="time" type="TIME"/>
        </createTable>
        <sql>ALTER TABLE public.daily OWNER TO report321;</sql>
    </changeSet>


    <!-- Mentoring subscription request -->
    <changeSet id="003-create-mentoring-subscription-request" author="init">
        <createTable tableName="mentoring_subscription_request" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="customer_phone" type="VARCHAR(255)"/>
            <column name="life_pay_transaction_number" type="VARCHAR(255)"/>
            <column name="tg_name" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.mentoring_subscription_request OWNER TO report321;</sql>
    </changeSet>


    <!-- Promocode -->
    <changeSet id="004-create-promocode" author="init">
        <createTable tableName="promocode" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="counter_used" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="created" type="TIMESTAMP"/>
            <column name="discount_percent" type="DOUBLE PRECISION">
                <constraints nullable="false"/>
            </column>
            <column name="is_active" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="max_uses_number" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="promocode_text" type="VARCHAR(255)"/>
            <column name="service_type" type="INTEGER"/>
        </createTable>
        <sql>ALTER TABLE public.promocode OWNER TO report321;</sql>
    </changeSet>


    <!-- Resume analysis request -->
    <changeSet id="005-create-resume-analysis-request" author="init">
        <createTable tableName="resume_analysis_request" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="cv_pdf" type="OID"/>
            <column name="tg_name" type="VARCHAR(255)"/>
            <column name="life_pay_number" type="VARCHAR(255)"/>
            <column name="phone" type="VARCHAR(255)"/>
            <column name="customer_phone" type="VARCHAR(255)"/>
            <column name="life_pay_transaction_number" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.resume_analysis_request OWNER TO report321;</sql>
    </changeSet>


    <!-- Schedule period -->
    <changeSet id="006-create-schedule-period" author="init">
        <createTable tableName="schedule_period" schemaName="public">
            <column name="id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="end_time" type="BIGINT"/>
            <column name="start_time" type="BIGINT"/>
        </createTable>
        <sql>ALTER TABLE public.schedule_period OWNER TO report321;</sql>
    </changeSet>


    <!-- Special chats -->
    <changeSet id="007-create-special-chats" author="init">
        <createTable tableName="special_chats" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="mentors_chat_id" type="VARCHAR(255)"/>
            <column name="report_chat_id" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.special_chats OWNER TO report321;</sql>
    </changeSet>
    <!-- User contract details -->
    <changeSet id="008-create-user-contract-details" author="init">
        <createTable tableName="user_contract_details" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="birth_date" type="DATE"/>
            <column name="contract_number" type="VARCHAR(255)"/>
            <column name="date" type="DATE"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="full_name" type="VARCHAR(255)"/>
            <column name="issue_date" type="DATE"/>
            <column name="passport_issued" type="DATE"/>
            <column name="passport_number" type="VARCHAR(255)"/>
            <column name="passport_series" type="VARCHAR(255)"/>
            <column name="phone_number" type="VARCHAR(255)"/>
            <column name="registration" type="VARCHAR(255)"/>
            <column name="user_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <sql>ALTER TABLE public.user_contract_details OWNER TO report321;</sql>
    </changeSet>


    <!-- User info -->
    <changeSet id="009-create-user-info" author="init">
        <createTable tableName="user_info" schemaName="public">
            <column name="user_name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="chat_id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_type" type="VARCHAR(255)"/>
            <column name="notify_about_reports" type="BOOLEAN"/>
            <column name="timezone" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.user_info OWNER TO report321;</sql>
    </changeSet>


    <!-- Contract -->
    <changeSet id="010-create-contract" author="init">
        <createTable tableName="contract" schemaName="public">
            <column name="username" type="VARCHAR(255)"/>
            <column name="contract_id" type="VARCHAR(255)"/>
            <column name="date" type="DATE"/>
            <column name="student_info_chat_id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="contract" baseColumnNames="student_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_contract_user_info"/>
        <sql>ALTER TABLE public.contract OWNER TO report321;</sql>
    </changeSet>


    <!-- Mentor -->
    <changeSet id="011-create-mentor" author="init">
        <createTable tableName="mentor" schemaName="public">
            <column name="user_name" type="VARCHAR(255)"/>
            <column name="is_active" type="BOOLEAN"/>
            <column name="room_url" type="VARCHAR(255)"/>
            <column name="mentor_info_chat_id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint baseTableName="mentor" baseColumnNames="mentor_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_mentor_user_info"/>
        <sql>ALTER TABLE public.mentor OWNER TO report321;</sql>
    </changeSet>


    <!-- Report -->
    <changeSet id="012-create-report" author="init">
        <createTable tableName="report" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="date" type="DATE"/>
            <column name="hours" type="INTEGER"/>
            <column name="student_user_name" type="VARCHAR(255)"/>
            <column name="title" type="VARCHAR(255)"/>
            <column name="user_info_chat_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="report" baseColumnNames="user_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_report_user_info"/>
        <sql>ALTER TABLE public.report OWNER TO report321;</sql>
    </changeSet>

    <!-- Review request -->
    <changeSet id="013-create-review-request" author="init">
        <createTable tableName="review_request" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="booked_date_time" type="TIMESTAMP"/>
            <column name="date" type="DATE"/>
            <column name="mentor_user_name" type="VARCHAR(255)"/>
            <column name="student_chat_id" type="VARCHAR(255)"/>
            <column name="student_user_name" type="VARCHAR(255)"/>
            <column name="time_slots" type="VARCHAR(255)"/>
            <column name="title" type="VARCHAR(255)"/>
            <column name="poll_message_id" type="INTEGER"/>
            <column name="student_info_chat_id" type="BIGINT"/>
            <column name="mentor_info_chat_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="review_request" baseColumnNames="student_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_review_request_student_user_info"/>
        <addForeignKeyConstraint baseTableName="review_request" baseColumnNames="mentor_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_review_request_mentor_user_info"/>
        <sql>ALTER TABLE public.review_request OWNER TO report321;</sql>
    </changeSet>


    <!-- Salary -->
    <changeSet id="014-create-salary" author="init">
        <createTable tableName="salary" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="date" type="DATE"/>
            <column name="salary" type="INTEGER"/>
            <column name="user_name" type="VARCHAR(255)"/>
            <column name="user_info_chat_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="salary" baseColumnNames="user_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_salary_user_info"/>
        <sql>ALTER TABLE public.salary OWNER TO report321;</sql>
    </changeSet>


    <!-- Step passed -->
    <changeSet id="015-create-step-passed" author="init">
        <createTable tableName="step_passed" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="date" type="DATE"/>
            <column name="step" type="VARCHAR(255)"/>
            <column name="student_user_name" type="VARCHAR(255)"/>
            <column name="student_info_chat_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="step_passed" baseColumnNames="student_info_chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_step_passed_user_info"/>
        <sql>ALTER TABLE public.step_passed OWNER TO report321;</sql>
    </changeSet>


    <!-- Personal call request -->
    <changeSet id="016-create-personal-call-request" author="init">
        <createTable tableName="personal_call_request" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="customer_phone" type="VARCHAR(255)"/>
            <column name="life_pay_transaction_number" type="VARCHAR(255)"/>
            <column name="tg_name" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.personal_call_request OWNER TO report321;</sql>
    </changeSet>


    <!-- Chat message -->
    <changeSet id="017-create-chat-message" author="init">
        <createTable tableName="chat_message" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="report_chat_bot_message_id" type="INTEGER"/>
            <column name="user_chat_bot_message_id" type="INTEGER"/>
            <column name="user_message_id" type="INTEGER"/>
            <column name="report_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="chat_message" baseColumnNames="report_id"
                                 referencedTableName="report" referencedColumnNames="id"
                                 constraintName="fk_chat_message_report"/>
        <sql>ALTER TABLE public.chat_message OWNER TO report321;</sql>
    </changeSet>

    <!-- Databasechangelog -->
    <changeSet id="018-create-databasechangelog" author="init">
        <createTable tableName="databasechangelog" schemaName="public">
            <column name="id" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="author" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="filename" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="dateexecuted" type="TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="orderexecuted" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="exectype" type="VARCHAR(10)">
                <constraints nullable="false"/>
            </column>
            <column name="md5sum" type="VARCHAR(35)"/>
            <column name="description" type="VARCHAR(255)"/>
            <column name="comments" type="VARCHAR(255)"/>
            <column name="tag" type="VARCHAR(255)"/>
            <column name="liquibase" type="VARCHAR(20)"/>
            <column name="contexts" type="VARCHAR(255)"/>
            <column name="labels" type="VARCHAR(255)"/>
            <column name="deployment_id" type="VARCHAR(10)"/>
        </createTable>
        <sql>ALTER TABLE public.databasechangelog OWNER TO report321;</sql>
    </changeSet>

    <!-- Databasechangeloglock -->
    <changeSet id="019-create-databasechangeloglock" author="init">
        <createTable tableName="databasechangeloglock" schemaName="public">
            <column name="id" type="INTEGER">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="locked" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="lockgranted" type="TIMESTAMP"/>
            <column name="lockedby" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.databasechangeloglock OWNER TO report321;</sql>
    </changeSet>

    <!-- UTM tag -->
    <changeSet id="020-create-utm-tag" author="init">
        <createTable tableName="utm_tag" schemaName="public">
            <column name="id" type="BIGINT">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="source" type="VARCHAR(255)"/>
            <column name="local_date_time" type="TIMESTAMP"/>
            <column name="section" type="VARCHAR(255)"/>
        </createTable>
        <sql>ALTER TABLE public.utm_tag OWNER TO report321;</sql>
    </changeSet>

    <!-- Payment details -->
    <changeSet id="021-create-payment-details" author="init">
        <createTable tableName="payment_details" schemaName="public">
            <column name="number" type="VARCHAR(255)">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="amount" type="VARCHAR(255)"/>
            <column name="card_holder" type="VARCHAR(255)"/>
            <column name="created" type="VARCHAR(255)"/>
            <column name="description" type="VARCHAR(255)"/>
            <column name="discount_amount" type="VARCHAR(255)"/>
            <column name="email" type="VARCHAR(255)"/>
            <column name="lat" type="DOUBLE PRECISION"/>
            <column name="lng" type="DOUBLE PRECISION"/>
            <column name="method" type="VARCHAR(255)"/>
            <column name="operator_login" type="VARCHAR(255)"/>
            <column name="operator_name" type="VARCHAR(255)"/>
            <column name="td_order" type="JSON"/>
            <column name="original_number" type="VARCHAR(255)"/>
            <column name="pan" type="VARCHAR(255)"/>
            <column name="phone" type="VARCHAR(255)"/>
            <column name="purchase" type="JSONB"/>
            <column name="recipient_inn" type="VARCHAR(255)"/>
            <column name="rrn" type="VARCHAR(255)"/>
            <column name="status" type="VARCHAR(255)"/>
            <column name="terminal_serial" type="VARCHAR(255)"/>
            <column name="tip_amount" type="VARCHAR(255)"/>
            <column name="td_type" type="VARCHAR(255)"/>
            <column name="service_type" type="INTEGER"/>
            <column name="utm_tag_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="payment_details" baseColumnNames="utm_tag_id"
                                 referencedTableName="utm_tag" referencedColumnNames="id"
                                 constraintName="fk_payment_details_utm_tag"/>
        <sql>ALTER TABLE public.payment_details OWNER TO report321;</sql>
    </changeSet>

    <!-- Promocode payment details set -->
    <changeSet id="022-create-promocode-payment-details-set" author="init">
        <createTable tableName="promocode_payment_details_set" schemaName="public">
            <column name="promocode_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="payment_details_set_number" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey tableName="promocode_payment_details_set" columnNames="promocode_id, payment_details_set_number"/>
        <addForeignKeyConstraint baseTableName="promocode_payment_details_set" baseColumnNames="promocode_id"
                                 referencedTableName="promocode" referencedColumnNames="id"
                                 constraintName="fk_promocode_payment_details_set_promocode"/>
        <addForeignKeyConstraint baseTableName="promocode_payment_details_set" baseColumnNames="payment_details_set_number"
                                 referencedTableName="payment_details" referencedColumnNames="number"
                                 constraintName="fk_promocode_payment_details_set_payment_details"/>
        <sql>ALTER TABLE public.promocode_payment_details_set OWNER TO report321;</sql>
    </changeSet>

    <!-- Notification pay -->
    <changeSet id="023-create-notification-pay" author="init">
        <createTable tableName="notification_pay" schemaName="public">
            <column name="id" type="BIGSERIAL">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="enable" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="chat_id" type="BIGINT"/>
        </createTable>
        <addForeignKeyConstraint baseTableName="notification_pay" baseColumnNames="chat_id"
                                 referencedTableName="user_info" referencedColumnNames="chat_id"
                                 constraintName="fk_notification_pay_user_info"/>
        <sql>ALTER TABLE public.notification_pay OWNER TO report321;</sql>
    </changeSet>

    <!-- Notification report -->
    <changeSet id="024-notification-Report-entity" author="init">
        <createTable tableName="notification_report">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="enable" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <insert tableName="notification_report">
            <column name="id" valueNumeric="1"/>
            <column name="enable" valueBoolean="false"/>
        </insert>
    </changeSet>
</databaseChangeLog>